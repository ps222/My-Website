function range(e){rangeside?($("#cropped").css("left",e+"px"),cropsizesTmp=[e,0,cropsizesTmp[2],cropsizesTmp[3]]):($("#cropped").css("top",e+"px"),cropsizesTmp=[0,e,cropsizesTmp[2],cropsizesTmp[3]]),$("#preview-work #preview-raw").css({"margin-top":"-"+Math.round(cropsizesTmp[1]/divisor)+"px","margin-left":"-"+Math.round(cropsizesTmp[0]/divisor)+"px"}),$("#product-crop").val(parseInt(cropsizesTmp[0]/devicediv)+","+parseInt(cropsizesTmp[1]/devicediv)+","+parseInt(cropsizesTmp[2]/devicediv)+","+parseInt(cropsizesTmp[3]/devicediv))}function resizePhoto(){parseInt($(window).width())<px?(devicediv=(parseInt($(window).width())-20)/px,slide(cropsizesTmp=[parseInt(cropsizes[0]*devicediv),parseInt(cropsizes[1]*devicediv),parseInt(cropsizes[2]*devicediv),parseInt(cropsizes[3]*devicediv)])):(cropsizesTmp=cropsizes,slide(cropsizes),devicediv=1),pxTmp=parseInt(px*devicediv),pyTmp=parseInt(py*devicediv),$("#product").attr("width",pxTmp).attr("height",pyTmp),$("#crop").css("width",pxTmp).css("height",pyTmp)}function slide(e){console.log(e),slidex=e[2]-e[0],slidey=e[3]-e[1],slidepx=pxTmp-slidex,slidepy=pyTmp-slidey,0==slidepx?($("#cropped").css("top",e[1]+"px"),rangeside=0):(rangeside=1,$("#cropped").css("left",e[0]+"px")),range(0),$("#cropped").css({width:slidex+"px",height:slidey+"px",left:"0px",top:"0px"}),$("#preview-work").css({width:Math.round(slidex/divisor)+"px",height:Math.round(slidey/divisor)+"px"}),$("#preview-h").css("left",-43+parseInt((parseInt($("#preview").css("width"))-parseInt($("#preview-work").css("width")))/2)).show(),$("#preview-w").show()}var rangeside,pxTmp,pyTmp,devicediv,cropsizesTmp,document_width,document_height;$(document).ready(function(){function e(e){$("#cropped").css({width:0}),$("#coppedlayer").html('<img style="position:absolute; top:45%; left:45%; z-index:999999" src="https://wallsheaven.global.ssl.fastly.net/static/img/wh-loading.gif">'),$.get("/ajax/price",e,function(e){if($("#coppedlayer").html(""),void 0!=e.price){if($("#price").text(e.price),$("#rawprice").text(e.rawprice),void 0!=e.priceoff&&e.priceoff>0&&$("#befordisscount").text(e.priceoff),void 0!=e.max){if($("#max-w").text(e.max.w),$("#max-h").text(e.max.h),$("#x").attr("max",e.max.w),$("#y").attr("max",e.max.h),"cm"==e.size.symbole)o="1";else if("ft"==e.size.symbole)o="0.01";else var o="0.1";$("#x").attr("step",o).attr("min",o),$("#y").attr("step",o).attr("min",o)}void 0!=e.size&&(e.keep1to1.access&&("x"==e.keep1to1.side?$("#y").val(e.size.y):$("#x").val(e.size.x)),void 0!=e.changetype&&($("#x").val(e.size.x),$("#y").val(e.size.y)),$("#product-x").val(e.size.x),$("#product-y").val(e.size.y),$("#product-type").val(e.size.type),$("#presize-w").text(e.size.x),$("#presize-h").text(e.size.y),$("#presize-type").text(e.size.type),$(".size-symbole").text(e.size.symbole),$("#showsize").text(W+e.size.x+" x "+H+e.size.y+" "+("inch"==e.size.symbole?"'":e.size.symbole)),e.max),void 0!=e.cropsize&&(slide(cropsizesTmp=[e.cropsize.x1,e.cropsize.y1,e.cropsize.x2,e.cropsize.y2]),$("#product-crop").val(e.cropsize.x1+","+e.cropsize.y1+","+e.cropsize.x2+","+e.cropsize.y2),$("#preview-h").css("left",-43+parseInt((parseInt($("#preview").css("width"))-parseInt($("#preview-work").css("width")))/2))),e.after}},"json")}function o(o){d=setTimeout(function(){e(o)},250)}function t(e){clearTimeout(d),testv={keep1to1:l,jx1:p,jy1:n,cw:cw,ch:ch,c:c,x:$("#x").val(),y:$("#y").val(),material_id:$("#material_id").attr("value"),product_id:$("#product_id").attr("value"),ajaxkey:ajaxkey,type:$("#product-type").attr("value"),px:pxTmp,py:pyTmp,after:$("#sizes-type option:selected").attr("value")},1==testv.keep1to1&&(testv.x<1||testv.y<1)||o(testv)}document_width=$(document).width(),document_height=$(document).height(),rangeside=0,pxTmp=px,pyTmp=py,devicediv=1,cropsizesTmp=cropsizes,$("#manual").hover(function(){$("#x, #y, #croppedbox, #vizualization-crop").addClass("active"),$("#vizualization-min .vizualization-min-box").eq(1).trigger("click")},function(){$("#x, #y, #croppedbox").removeClass("active")}),$("#likeproduct").click(function(){add=$(this).hasClass("active"),add?$(this).removeClass("active"):$(this).addClass("active"),$.get("/ajax/wishlist",{active:!add,type:"favorite",id:idp},function(e){})}),$(".share-buttons li a img").hover(function(){$(this).removeClass("grayscale")},function(){$(this).addClass("grayscale")}),void 0!=$.cookie("closecookie")&&($("#closecookie").parent().hide(),$("#insidephotos").css("border","0px")),$("#closecookie").click(function(){$("#closecookie").parent().hide(),$.cookie("closecookie","1",{expires:7})}),$(window).resize(function(){window.innerWidth!==this.previousWidth&&(orient=window.innerHeight>=window.innerWidth?"portrait":"landscape"),void 0!=this.orientation&&(orient=90==Math.abs(this.orientation)?"landscape":"portrait"),("portrait"==orient&&document_width!=$(document).width()||"landscape"==orient&&document_width!=$(document).width())&&("portrait"==orient&&Math.abs(document_width-$(document).width())>50||"landscape"==orient&&Math.abs(document_width-$(document).width())>50)&&(document_width=$(document).width(),document_height=$(document).height(),resizePhoto())}),mobile||(pxTmp=px,pyTmp=py);var i=0,a=0,s=0,r=0;$("#cropped").on("mousedown touchstart pointerdown MSPointerDown",function(e){$("body").addClass("unselectable"),rangeside?(s=parseInt($("#cropped").css("left")),i=e.clientX):(r=parseInt($("#cropped").css("top")),a=e.clientY),$("#cropped").bind("mousemove touchmove pointermove",function(e){var o=e,t=e.originalEvent,d=t&&t.touches;if(d){if(touchesLength=d.length,touchesLength>1){if(!options.zoomable||!options.zoomOnTouch||2!==touchesLength)return;o=d[1],this.endX2=o.pageX,this.endY2=o.pageY}o=d[0]}rangeside?(offsetX=o.clientX,pxleft=Math.abs(i-offsetX),i>offsetX?(s-=pxleft)<0&&(s=0):i<offsetX&&(s+=pxleft,pxTmp<s+cropsizesTmp[2]&&(s=pxTmp-cropsizesTmp[2])),i=offsetX,range(s)):(offsetY=o.clientY,pyleft=Math.abs(a-offsetY),a>offsetY?(r-=pyleft)<0&&(r=0):a<offsetY&&(r+=pyleft,pyTmp<r+cropsizesTmp[3]&&(r=pyTmp-cropsizesTmp[3])),a=offsetY,range(r)),e.preventDefault()})}).mouseup(function(){$("#cropped").unbind("mousemove touchmove pointermove"),$("body").removeClass("unselectable")}).mouseleave(function(){$("#cropped").unbind("mousemove touchmove pointermove")}),$("#stars").click(function(){var e=$(this).attr("data-add");$.get("/ajax/stars",{add:e,id:$("#product_id").val()},function(e){1==e?$("#stars").attr("data-add",1).addClass("active"):$("#stars").attr("data-add",0).removeClass("active")})}),$("#choose-type").change(function(){window.location=$(this).find("option:selected").attr("data-url")}),$("#effect input").change(function(){$("#product-effect").attr("value",$(this).val()),$("#preview-raw").removeClass("standard grayscale sepia").addClass($(this).val()),$("#product").removeClass("standard grayscale sepia").addClass($(this).val())}),$("#reflection input").change(function(){$("#product-reflection").attr("value",$(this).val()),$("#preview-raw").removeClass("standard horizontal vertical horizontalvertical").addClass($(this).val()),$("#product").removeClass("standard horizontal vertical horizontalvertical").addClass($(this).val())}),$("#selectmaterial input").change(function(){$("#material_id").attr("value",$(this).val()),t("material")}),mobile&&($("#reflection sel").hide(),$("#effect sel").hide(),$("h4.toggle").click(function(){$(this).parent().find("sel").toggle()})),$("#sizes-type").change(function(){console.log("change"),t("sizetype")});var d,p=0,n=0,m=!1;$("#x, #y").bind("keyup",function(e){if(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105||188==e.keyCode||190==e.keyCode||13==e.keyCode||8==e.keyCode||46==e.keyCode){if(m=!0,this.value<1)return;if((8==e.keyCode||46==e.keyCode)&&this.value<1)return;t(e.id),xyname=$(this).attr("name"),"x"==xyname&&parseFloat($(this).val())>parseFloat($("#max-w").text())||"y"==xyname&&parseFloat($(this).val())>parseFloat($("#max-h").text())?($("#max-"+xyname).addClass("colorblue"),$("#"+xyname).addClass("colorred")):($("#max-"+("x"==xyname?"w":"h")).removeClass("colorblue"),$("#"+xyname).removeClass("colorred"))}}),$("#x, #y").bind("change",function(e){if(!m){if(this.value<1)return;t(e.id),xyname=$(this).attr("name"),"x"==xyname&&parseFloat($(this).val())>parseFloat($("#max-w").text())||"y"==xyname&&parseFloat($(this).val())>parseFloat($("#max-h").text())?($("#max-"+xyname).addClass("colorblue"),$("#"+xyname).addClass("colorred")):($("#max-"+("x"==xyname?"w":"h")).removeClass("colorblue"),$("#"+xyname).removeClass("colorred"))}});var l=0;$("#keep1to1").change(function(){l=$("#keep1to1").prop("checked")?1:0,t("keep1to1")});$("#vizualization-min .vizualization-min-box").click(function(){var e=$("#vizualization-min .vizualization-min-box.active").attr("data-id");$("#vizualization-min .vizualization-min-box.active").removeClass("active");var o=$(this).attr("data-id");$(this).addClass("active"),e!=o&&("1"==o?$("#maxsize .size-symbole, #sizes-type, #max-w, #max-h, #x, #y").css({"font-weight":"bolder"}):"0"!=o&&"2"!=o||$("#maxsize .size-symbole, #sizes-type, #max-w, #max-h, #x, #y").css({"font-weight":"normal"}),$("#viznew div photo").hide().eq(o).show())}),$("#cropped").show(),slide(cropsizesTmp),resizePhoto()}),$(document).ready(function(){var e,o,t,i=px,a=py,s=1,r=0,d=new Array;d[r]=new Array,d[r].x_dom=0,d[r].y_dom=0;var c=new Array;c[r]=new Array,c[r].cor_x_dom=0,c[r].cor_y_dom=0;var p=Math.round(px/4),n=Math.round(py/4),m=$("#product").attr("src");$("#zoom-out").click(function(){--r<=0&&(r=0),(s/=2)<1&&(s=1),e="/ajax/zoomimage/"+idp+"/"+s+"?xdem="+d[r].x_dom+"&ydem="+d[r].y_dom+"&ajaxkey="+ajaxkey+"&zoomajax="+zoomajax,$("#loader-zoom").show(),$("#zoom-pick").attr("src",e).load(function(){$("#loader-zoom").hide()})}),$("#zoom-reset").click(function(){r=0,s=1,e="/ajax/zoomimage/"+idp+"/"+s+"?xdem="+d[r].x_dom+"&ydem="+d[r].y_dom+"&ajaxkey="+ajaxkey+"&zoomajax="+zoomajax,$("#loader-zoom").show(),$("#zoom-pick").attr("src",e).load(function(){$("#loader-zoom").hide()})}),lockzoom=0,$("#zoom-pick").click(function(l){0==lockzoom&&(lockzoom=1,setTimeout(function(){lockzoom=0},5e3),8==s?(s=1,r=0):(o=p/s,t=n/s,c[++r]=new Array,d[r]=new Array,d[r].x_dom=c[r-1].cor_x_dom+i/s*(l.pageX-$(this).offset().left)/i,d[r].y_dom=c[r-1].cor_y_dom+a/s*(l.pageY-$(this).offset().top)/a,d[r].x_dom>i-o&&(d[r].x_dom=i-o),d[r].y_dom>a-t&&(d[r].y_dom=a-t),c[r].cor_x_dom=d[r].x_dom-o,c[r].cor_y_dom=d[r].y_dom-t,c[r].cor_x_dom<0&&(c[r].cor_x_dom=0),c[r].cor_x_dom>i-o&&(c[r].cor_x_dom=i-o),c[r].cor_y_dom>a-t&&(c[r].cor_y_dom=a-t),c[r].cor_y_dom<0&&(c[r].cor_y_dom=0),s*=2),e="/ajax/zoomimage/"+idp+"/"+s+"?xdem="+d[r].x_dom+"&ydem="+d[r].y_dom+"&ajaxkey="+ajaxkey+"&zoomajax="+zoomajax,$("#loader-zoom").show(),$("#zoom-pick").attr("src",e).load(function(){$("#loader-zoom").hide(),lockzoom=0}).error(function(){lockzoom=0,s=1,r=0,e="/ajax/zoomimage/"+idp+"/"+s+"?xdem="+d[r].x_dom+"&ydem="+d[r].y_dom+"&ajaxkey="+ajaxkey+"&zoomajax="+zoomajax,$("#zoom-pick").attr("src",m)}))})});